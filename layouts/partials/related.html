{{ $related := .Site.RegularPages.Related . | first 4 }}
{{ with $related }}
<div class="related--content">
    <h3 class="fRelated--heroTitle">{{ i18n "article.relatedContent" }}</h3>
    <div class="fRelated--list">
        {{ range . }}
        <div class="fRelated--item">
            <a href="{{ .RelPermalink }}" title="{{ .Title }}" aria-label="{{ .Title }}">
                <div class="fRelated--cover">
                    {{ if .Params.cover }}
                    {{ with .Resources.Get .Params.cover }}
                    {{ with .Fill "620x310 Center" }}
                    <img src="{{ .RelPermalink }}" alt="{{ .Title }}" class="cover">
                    {{ end }}
                    {{ end }}
                    {{ else if .Content }}
                    {{ $urls := findRE "<img src=\"[^\"|\\\"]*\"" .Content }} {{ if $urls }} {{ $url :=index ($urls) 0
                        }} {{ $url :=(strings.TrimPrefix "<img src=\"" $url) }}
      {{ $url := strings.TrimRight " \"" $url }} <img src="{{ $url }}" class="cover" alt="{{ .Title }}" />
                    {{ end }}
                    {{ end }}
                </div>
                <div class="fRelated--title">
                    {{ .Title }}
                </div>
                <div class="fRelated--meta">
                    {{ if .Date }}
                    {{ partial "time.html" . }}
                    <span class="sep"></span>
                    {{ end }}
                    {{ T "article.readingTime" .ReadingTime }}
                </div>
            </a>
        </div>
        {{ end }}
    </div>
</div>
{{ end }}